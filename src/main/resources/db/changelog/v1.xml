<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <property name="now" value="now()" dbms="mysql,h2,tidb,postgresql"/>
    <property name="now" value="sysdate" dbms="oracle,dm"/>
    <property name="amount" value="decimal(20,2)"/>

    <changeSet author="bin.xie (generated)" id="admin_1706146730436-18">
        <createTable tableName="oauth2_authorization">
            <column name="id" type="varchar(100)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="registered_client_id" type="varchar(100)"/>
            <column name="principal_name" type="varchar(200)"/>
            <column name="authorization_grant_type" type="varchar(100)"/>
            <column name="authorized_scopes" type="varchar(500)"/>
            <column name="attributes" type="BLOB"/>
            <column name="state" type="varchar(500)"/>
            <column name="authorization_code_value" type="varchar(500)"/>
            <column name="authorization_code_issued_at" type="timestamp"/>
            <column name="authorization_code_expires_at" type="timestamp"/>
            <column name="authorization_code_metadata" type="BLOB"/>
            <column name="access_token_value" type="varchar(200)"/>
            <column name="access_token_issued_at" type="timestamp"/>
            <column name="access_token_expires_at" type="timestamp"/>
            <column name="access_token_metadata" type="BLOB"/>
            <column name="access_token_type" type="varchar(100)"/>
            <column name="access_token_scopes" type="varchar(500)"/>
            <column name="oidc_id_token_value" type="varchar(200)"/>
            <column name="oidc_id_token_issued_at" type="timestamp"/>
            <column name="oidc_id_token_expires_at" type="timestamp"/>
            <column name="oidc_id_token_metadata" type="BLOB"/>
            <column name="refresh_token_value" type="varchar(200)"/>
            <column name="refresh_token_issued_at" type="timestamp"/>
            <column name="refresh_token_expires_at" type="timestamp"/>
            <column name="refresh_token_metadata" type="BLOB"/>
            <column name="user_code_value" type="varchar(200)"/>
            <column name="user_code_issued_at" type="timestamp"/>
            <column name="user_code_expires_at" type="timestamp"/>
            <column name="user_code_metadata" type="BLOB"/>
            <column name="device_code_value" type="varchar(200)"/>
            <column name="device_code_issued_at" type="timestamp"/>
            <column name="device_code_expires_at" type="timestamp"/>
            <column name="device_code_metadata" type="BLOB"/>
        </createTable>
    </changeSet>
    
    <changeSet author="bin.xie (generated)" id="admin_1706146730436-19">
        <createTable tableName="oauth2_authorization_consent">
            <column name="registered_client_id" type="varchar(100)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="principal_name" type="varchar(200)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="authorities" type="varchar(1000)"/>
        </createTable>
    </changeSet>
    <changeSet author="bin.xie (generated)" id="admin_1706146730436-20">
        <createTable tableName="oauth2_registered_client">
            <column name="id" type="varchar(100)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="client_id" type="varchar(100)"/>
            <column name="client_id_issued_at" type="timestamp"/>
            <column name="client_secret_expires_at" type="timestamp"/>
            <column name="client_secret" type="varchar(200)"/>
            <column name="client_name" type="varchar(200)"/>
            <column name="client_authentication_methods" type="varchar(1000)"/>
            <column name="authorization_grant_types" type="varchar(1000)"/>
            <column name="redirect_uris" type="varchar(1000)"/>
            <column name="post_logout_redirect_uris" type="varchar(1000)"/>
            <column name="scopes" type="varchar(1000)"/>
            <column name="client_settings" type="varchar(2000)"/>
            <column name="token_settings" type="varchar(2000)"/>
        </createTable>
    </changeSet>


    <changeSet id="admin_1733456516869-1" author="bin.xie (generated)">
        <sql>
            insert into oauth2_registered_client (id, client_id, client_id_issued_at, client_secret_expires_at, client_secret, client_name, client_authentication_methods, authorization_grant_types, redirect_uris, post_logout_redirect_uris, scopes, client_settings, token_settings) values ('5dc3e5877e5aa57b3870624e7e83d141', 'MOBILE', '2023-10-09 16:14:24', null, '{noop}nLCnwdIhizWbykHyuZM6TpQDd7KwK9IXDK8LGsa7SOW', '5dc3e5877e5aa57b3870624e7e83d141', 'client_secret_post,client_secret_basic', 'refresh_token,password', '', '', 'read,write', '{"@class":"java.util.Collections$UnmodifiableMap","settings.client.require-proof-key":false,"settings.client.require-authorization-consent":false}', '{"@class":"java.util.Collections$UnmodifiableMap","settings.token.reuse-refresh-tokens":true,"settings.token.id-token-signature-algorithm":["org.springframework.security.oauth2.jose.jws.SignatureAlgorithm","RS256"],"settings.token.access-token-time-to-live":["java.time.Duration",7200.000000000],"settings.token.access-token-format":{"@class":"org.springframework.security.oauth2.server.authorization.settings.OAuth2TokenFormat","value":"reference"},"settings.token.refresh-token-time-to-live":["java.time.Duration",2592000.000000000],"settings.token.authorization-code-time-to-live":["java.time.Duration",300.000000000],"settings.token.device-code-time-to-live":["java.time.Duration",300.000000000]}');
            insert into oauth2_registered_client (id, client_id, client_id_issued_at, client_secret_expires_at, client_secret, client_name, client_authentication_methods, authorization_grant_types, redirect_uris, post_logout_redirect_uris, scopes, client_settings, token_settings) values ('1153e438235e95f145ea005503766cf8', 'PC', '2023-10-09 16:14:24', null, '{bcrypt}$2a$10$wqiQMMQ9iY6YGRZ/oPeAK.XsgZoYuV5HDOWphg/xlpKcgznc/tlZO', '1153e438235e95f145ea005503766cf8', 'client_secret_post,client_secret_basic', 'refresh_token,password', '', '', 'read,write', '{"@class":"java.util.Collections$UnmodifiableMap","settings.client.require-proof-key":false,"settings.client.require-authorization-consent":false}', '{"@class":"java.util.Collections$UnmodifiableMap","settings.token.reuse-refresh-tokens":true,"settings.token.id-token-signature-algorithm":["org.springframework.security.oauth2.jose.jws.SignatureAlgorithm","RS256"],"settings.token.access-token-time-to-live":["java.time.Duration",7200.000000000],"settings.token.access-token-format":{"@class":"org.springframework.security.oauth2.server.authorization.settings.OAuth2TokenFormat","value":"reference"},"settings.token.refresh-token-time-to-live":["java.time.Duration",2592000.000000000],"settings.token.authorization-code-time-to-live":["java.time.Duration",300.000000000],"settings.token.device-code-time-to-live":["java.time.Duration",300.000000000]}');
            insert into oauth2_registered_client (id, client_id, client_id_issued_at, client_secret_expires_at, client_secret, client_name, client_authentication_methods, authorization_grant_types, redirect_uris, post_logout_redirect_uris, scopes, client_settings, token_settings) values ('556912e29270f87f9f8381f0ee8c5834', 'implement-integration', '2023-10-09 16:14:28', null, '{bcrypt}$2a$10$X8/tBYjN/x3eZ4/FSpS8.e4lFQkN94IS3UfSlrSsQetcGLg8tsMmS', '556912e29270f87f9f8381f0ee8c5834', 'client_secret_post,client_secret_basic', 'client_credentials', '', '', 'read,write', '{"@class":"java.util.Collections$UnmodifiableMap","settings.client.require-proof-key":false,"settings.client.require-authorization-consent":false}', '{"@class":"java.util.Collections$UnmodifiableMap","settings.token.reuse-refresh-tokens":true,"settings.token.id-token-signature-algorithm":["org.springframework.security.oauth2.jose.jws.SignatureAlgorithm","RS256"],"settings.token.access-token-time-to-live":["java.time.Duration",7200.000000000],"settings.token.access-token-format":{"@class":"org.springframework.security.oauth2.server.authorization.settings.OAuth2TokenFormat","value":"reference"},"settings.token.refresh-token-time-to-live":["java.time.Duration",2592000.000000000],"settings.token.authorization-code-time-to-live":["java.time.Duration",300.000000000],"settings.token.device-code-time-to-live":["java.time.Duration",300.000000000]}');
            insert into oauth2_registered_client (id, client_id, client_id_issued_at, client_secret_expires_at, client_secret, client_name, client_authentication_methods, authorization_grant_types, redirect_uris, post_logout_redirect_uris, scopes, client_settings, token_settings) values ('1f2e1d8c27bac163ba10265b4386e8dc', 'MOBILE_APP', '2023-10-09 16:14:30', null, '{bcrypt}$2a$10$2TZgleyVSQnHu/M4GKWGaeJA/jrbHkgOtqMoqwO1aJ21e0Mc/ZhGu', '1f2e1d8c27bac163ba10265b4386e8dc', 'client_secret_post,client_secret_basic', 'refresh_token,password', '', '', 'read,write', '{"@class":"java.util.Collections$UnmodifiableMap","settings.client.require-proof-key":false,"settings.client.require-authorization-consent":false}', '{"@class":"java.util.Collections$UnmodifiableMap","settings.token.reuse-refresh-tokens":true,"settings.token.id-token-signature-algorithm":["org.springframework.security.oauth2.jose.jws.SignatureAlgorithm","RS256"],"settings.token.access-token-time-to-live":["java.time.Duration",2592000.000000000],"settings.token.access-token-format":{"@class":"org.springframework.security.oauth2.server.authorization.settings.OAuth2TokenFormat","value":"reference"},"settings.token.refresh-token-time-to-live":["java.time.Duration",2592000.000000000],"settings.token.authorization-code-time-to-live":["java.time.Duration",300.000000000],"settings.token.device-code-time-to-live":["java.time.Duration",300.000000000]}');
        </sql>
    </changeSet>


    <changeSet id="admin_202412061212001" author="bin.xie">
        <createTable tableName="sys_user" remarks="用户表">
            <column name="id" type="bigint" remarks="id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sys_user"/>
            </column>
            <column name="tenant_id" type="bigint" remarks="租户id"/>
            <column name="code" type="varchar(50)" remarks="用户代码"/>
            <column name="name" type="varchar(20)" remarks="用户名称"/>
            <column name="nick_name" type="varchar(200)" remarks="用户别名"/>
            <column name="passwd" type="varchar(200)" remarks="密码"/>
            <column name="phone_number" type="varchar(20)" remarks="手机号"/>
            <column name="email" type="varchar(100)" remarks="邮箱"/>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_date" remarks="创建日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="last_updated_date" remarks="最后修改日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" remarks="创建人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_by" remarks="最后修改人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="version_number" remarks="版本" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>


    <changeSet id="admin_202412061212002" author="bin.xie">
        <createTable tableName="sys_role" remarks="角色表">
            <column name="id" type="bigint" remarks="id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sys_role"/>
            </column>
            <column name="tenant_id" type="bigint" remarks="租户id"/>
            <column name="code" type="varchar(50)" remarks="角色代码"/>
            <column name="name" type="varchar(20)" remarks="角色名称"/>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_date" remarks="创建日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="last_updated_date" remarks="最后修改日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" remarks="创建人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_by" remarks="最后修改人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="version_number" remarks="版本" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>


    <changeSet id="admin_202412061212003" author="bin.xie">
        <createTable tableName="sys_user_role" remarks="用户角色表">
            <column name="id" type="bigint" remarks="id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sys_role"/>
            </column>
            <column name="tenant_id" type="bigint" remarks="租户id"/>
            <column name="user_id" type="bigint" remarks="用户id"/>
            <column name="role_id" type="bigint" remarks="角色id"/>
            <column name="date_from" type="datetime" remarks="有效期从"/>
            <column name="date_to" type="datetime" remarks="有效期至"/>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_date" remarks="创建日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="last_updated_date" remarks="最后修改日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" remarks="创建人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_by" remarks="最后修改人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="version_number" remarks="版本" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>


    <changeSet id="admin_202412061212004" author="bin.xie">
        <createTable tableName="sys_menu" remarks="菜单表">
            <column name="id" type="bigint" remarks="id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sys_menu"/>
            </column>
            <column name="tenant_id" type="bigint" remarks="租户id"/>
            <column name="code" type="varchar(20)" remarks="菜单代码"/>
            <column name="name" type="varchar(100)" remarks="菜单名称"/>
            <column name="icon" type="varchar(100)" remarks="图标"/>
            <column name="type" type="tinyint" remarks="类型 1-目录 2-菜单"/>
            <column name="show" type="tinyint" remarks="是否展示"/>
            <column name="order_number" type="int" remarks="序号"/>
            <column name="url" type="varchar(100)" remarks="url"/>
            <column name="router" type="varchar(100)" remarks="路由"/>
            <column name="file_path" type="varchar(100)" remarks="js文件路径"/>
            <column name="parent_id" type="bigint" remarks="上级id"/>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_date" remarks="创建日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="last_updated_date" remarks="最后修改日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" remarks="创建人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_by" remarks="最后修改人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="version_number" remarks="版本" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>


    <changeSet id="admin_202412061212005" author="bin.xie">
        <createTable tableName="sys_role_menu" remarks="角色菜单表">
            <column name="id" type="bigint" remarks="id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sys_role_menu"/>
            </column>
            <column name="tenant_id" type="bigint" remarks="租户id"/>
            <column name="menu_id" type="bigint" remarks="菜单id"/>
            <column name="role_id" type="bigint" remarks="角色id"/>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="created_date" remarks="创建日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column defaultValueComputed="CURRENT_TIMESTAMP" name="last_updated_date" remarks="最后修改日期" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="created_by" remarks="创建人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="last_updated_by" remarks="最后修改人" type="bigint">
                <constraints nullable="false"/>
            </column>
            <column name="version_number" remarks="版本" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
</databaseChangeLog>
